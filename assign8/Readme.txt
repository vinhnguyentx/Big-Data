For assignment 8, you'll implement a map-reduce program that launches multiple jobs, some executing serially and some executing concurrently.

Start with assignment 7 code: output sessions into bins based on the session type, but only filter out large sessions. When this job has completed, add the creation, launch, monitoring, and completion of four map-reduce jobs that determine event subtype statistics in submitter, clicker, shower, and visitor sessions. You'll create and configure these jobs in the run() method, launching each job so that they run concurrently. Your code should then wait for all four of these jobs to complete.  When these four jobs have completed, create, configure, and launch a fifth job that aggregates the statistics across all four session types by reading the output files generated by the four previous jobs. You will use the Job class methods we discussed in class (submit(), isComplete()). All this code will be in the run() method, or called from the run() method of your (single) map-reduce program.

Event SubType Statistics

For event subtype statistics, collect data just as we did for the WordStatistics assignment, replacing "words" with the session type and event subtype event. One aspect will be different than what we did in WordStatistics: in WordStatistics we computed the mean and variance for the word count only in those documents in which the word appeared. For event subtypes, we want to calculate the mean and variance across all sessions, whether the session had that event subtype or not.  Use the following AVRO schema for the key and value of the event subtype statistics (available on Canvas: Files / Assignment 8):

eventSubTypeStatsData.avsc
eventSubTypeStatsKey.avsc
Output of the four jobs collecting stats for specific session types should be written using AvroKeyValueOutputFormat. Output of the last job that aggregates the statistics should be written using TextOutputFormat.

Some hints on what you'll need to do:

- For the jobs that collect event subtype statistics, you'll need to explicitly define the mapper output schema (key and value), even though it is the same as the job output schema.  I had to do this to get these jobs to work.

- Feel free to use the session.avsc file and the AVRO container file I generated with this schema for Assignment 7. Remember that you need to use both files. You can also use your own session generation code and schema if you prefer.

session.avsc is provided on Canvas (Files / Solutions / Assignment 7), as is the AVRO container file.

Required elements

Do the binning as we did in Assignment 7, but only filter out large sessions.
The four jobs that compute statistics for submitter, clicker, shower, and visitor sessions should run in parallel.
Final output should have statistics for each event subtype for each session type (submitter, clicker, shower, and visitor), as well as these statistics for these four session types combined.

Extra Credit (3 points):

In addition to calculating the statistics for each session type, and for all session types, also calculate the statistics for any event subType for each session type, and for all session types together.
